---
title: "RAMP/COPING treatment paper core notebook"

author: "K L Purves"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 2
    toc_float:
      collapsed: false
    number_sections: false
    highlight: monochrome
    theme: cerulean
code_folding: show

html_notebook:
  theme: cerulean
toc: yes
---

This workbook runs code and shows results for the manuscript ***Access and uptake of mental health services during the COVID-19 pandemic: rates, barriers and usefulness***. 

# Project description

## Research questions

1. What are the rates for treatment seeking for MH concerns at each time point (wave)
- rates over time

2. 

## Details, discussion and questions

How do we show change over time in treatment seeking and receipt over time?
- are services overwhelmed?

## Predictors

We select predictors that predict worse outcomes for common mental health problems in this sample (see [https://github.com/klpurves/PANCHANGE_analysis/tree/forest_plots]())


## submission

Will submit to Psychological Medicine in first instance

## variables that need creating

- did you seek treatment at any time


# set up 

Clear global environment
```{r Clear global environment}
remove(list = ls())
```

## Call in set up scripts

```{r source files}
#source data directory: data_path
source("/Users/kirstin/Dropbox/SGDP/RAMP/Projects/Treatment/file_paths.R")
setwd(wd)
source("./scripts/palettes.R")
source("./scripts/libraries.R")

```


```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      comment=NA,
                      prompt=FALSE,
                      cache=FALSE,
                      root.dir=wd)

knitr::opts_chunk$set(fig.path="figures/")



options(bitmapType = 'quartz') # to render fonts better
```

Retrieve the current date to use it for file endings to not overwrite files when one exports files
```{r Recent date}
date = Sys.Date()
```

# R functions

```{r call in function library functions}

# source all functions in the function library folder

files.sources = paste0("/FunctionLib",list.files("/FunctionLib"))

sapply(files.sources, source)

```

# Data import
## Read in data for RAMP
```{r read in data}
treatRAMP <- readRDS(file = paste0(data_path, "/ramp_followupb/treatment_ramp_followupb.rds"))
demRAMP <- readRDS(file = paste0(data_path, "/ramp/dem_ramp.RDS"))

```

## Create a wave column for RAMP 

Base this on dates of the follow ups

```{r add wave column ramp}


```

## Create data set per wave for RAMP treatment



## Merge Waves as columns, add demographics



## Exclusions

- Only inxluding those who sought (or di not seek) help for themselves

## Figures

1. Covid figures, lockdown dates, histogram/density 
2. Horizontal stacked bars showing proportion of people seeking treatment
3. Bar plot showing the proportion of respondents that sought treatment by wave, and stacked by proportion of those who received it. 



